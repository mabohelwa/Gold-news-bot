import logging
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
logging.basicConfig(level=logging.INFO)

TOKEN = "ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª Ù‡Ù†Ø§"
PASSWORD = "Asdf@1234$1234$"

# Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ù„Ù‡Ù…
AUTHORIZED_USERS = set()
WAITING_FOR_PASSWORD = set()

# Ø£Ù…Ø± Ø§Ù„Ø¨Ø¯Ø¡
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id in AUTHORIZED_USERS:
        await update.message.reply_text("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ Ù…Ù† Ø¬Ø¯ÙŠØ¯! âœ…")
    else:
        WAITING_FOR_PASSWORD.add(user_id)
        await update.message.reply_text("ğŸ” Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:")

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    text = update.message.text.strip()

    if user_id in WAITING_FOR_PASSWORD:
        if text == PASSWORD:
            AUTHORIZED_USERS.add(user_id)
            WAITING_FOR_PASSWORD.remove(user_id)
            await update.message.reply_text("âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚! Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø¨ÙˆØª.")
        else:
            await update.message.reply_text("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")
    elif user_id in AUTHORIZED_USERS:
        await update.message.reply_text("ğŸ‘‹ Ø£Ù†Øª Ø¨Ø§Ù„ÙØ¹Ù„ Ù…Ø³Ø¬Ù„! ØªØ§Ø¨Ø¹ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ù‡Ù†Ø§.")
    else:
        await update.message.reply_text("ğŸ” Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¨Ø¯Ø£ Ø¨Ù€ /start.")

# ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
if __name__ == '__main__':
    app = ApplicationBuilder().token(TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    app.run_polling()
